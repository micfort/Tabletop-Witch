<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>

<canvas id="myCanvas" width="0" height="0" style="display: none;"></canvas>
<div id="image"></div>
<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="http://colorbrewer2.org/export/colorbrewer.js"></script>
<script>

	var colorSet = colorbrewer.Set1[9];
	var symbolInfo = {offset:{x:0, y: -3}, font: "20px Calibri"};
	var wallPositions = {
		"b":{x1: 0, y1: 1, x2: 1, y2: 1},
		"t":{x1: 0, y1: 0, x2: 1, y2: 0},
		"l":{x1: 0, y1: 0, x2: 0, y2: 1},
		"r":{x1: 1, y1: 0, x2: 1, y2: 1}
	}

    function Symbol(map, symbol, position)
    {
		map.context.font = symbolInfo.font;
		map.context.textAlign = "center";
		map.context.fillStyle = colorSet[1];

		map.context.fillText(symbol,
						map.cellSize.x*(position.x+0.5)+symbolInfo.offset.x,
						map.cellSize.y*(position.y+1.0)+symbolInfo.offset.y);
    }

	function Wall(map, wall)
	{
		var direction = wallPositions[wall.direction];
		map.context.moveTo((wall.x+direction.x1)*map.cellSize.x, (wall.y+direction.y1)*map.cellSize.y);
		map.context.lineTo((wall.x+direction.x2)*map.cellSize.x, (wall.y+direction.y2)*map.cellSize.y);
	}

	var map =
	{
		"cellSize": {"x": 20, "y": 20},
		"gridSize": {"x": 30, "y": 30},

		"symbolList":
				[
					{"x":1, "y":1, "symbol":"1"},
					{"x":1, "y":2, "symbol":"B"},
					{"x":5, "y":3, "symbol":"M"}
				],

		"wallList":
			[
				{"direction":"b", "x":1, "y":2},
				{"direction":"b", "x":2, "y":2},
				{"direction":"t", "x":3, "y":2},
				{"direction":"r", "x":5, "y":2},
				{"direction":"l", "x":9, "y":2}
			]
	};

	var TotalSize =
	{
		x: map.cellSize.x*map.gridSize.x,
		y: map.cellSize.y*map.gridSize.y
	};

    var canvas = document.getElementById('myCanvas');
	$("#myCanvas").attr("width", TotalSize.x);
	$("#myCanvas").attr("height", TotalSize.y);
	map.context = canvas.getContext('2d');

	map.context.beginPath();

	//draw grid
    for(var i = 1; i < map.gridSize.x; i++)
    {
		map.context.moveTo(i * map.cellSize.x, 0);
		map.context.lineTo(i * map.cellSize.x, TotalSize.y);
    }

    for(var i = 1; i < map.gridSize.y; i++)
    {
		map.context.moveTo(0, i * map.cellSize.y);
		map.context.lineTo(TotalSize.x, i * map.cellSize.y);
    }

	map.context.strokeStyle = colorSet[9];
	map.context.stroke();

	//draw walls
	map.context.beginPath();
	for(var i = 0; i < map.wallList.length; i++)
	{
		Wall(map, map.wallList[i]);
	}
	map.context.lineWidth = 3;
	map.context.strokeStyle = colorSet[0];
	map.context.stroke();

	//draw symbols
	for(var i = 0; i < map.symbolList.length; i++)
	{
		Symbol(map, map.symbolList[i].symbol, {x:map.symbolList[i].x, y:map.symbolList[i].y});
	}

	var dataUrl = canvas.toDataURL("image/png");
	$("#image").html("<img src=\"" + dataUrl + "\" />");
</script>

</body>
</html>